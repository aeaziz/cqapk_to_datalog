
Datalog rewriting of CERTAINTY(q) with q = R(a,X), S(X,Y,Z), T(X,Z,Y)
CERTAINTY :- R(a,X), not BadBlock_0.
BadBlock_0 :- R(a,X), not RewriteAtom_1(X).
Eq_T(X,Z,X,Z) :- T(X,Z,Y).
Eq_S(X,Y,X,Y) :- S(X,Y,Z).
Neq_T(X,Z,X,Z_0) :- T(X,Z,Y), T(X,Z_0,Y_0), not Eq_T(X,Z,X,Z_0).
Neq_S(X,Y,X,Y_0) :- not Eq_S(X,Y,X,Y_0), S(X,Y,Z), S(X,Y_0,Z_0).
Rlvant_T(X,Z,Y) :- T(X,Z,Y), S(X,Y,Z).
Rlvant_S(X,Y,Z) :- T(X,Z,Y), S(X,Y,Z).
Garbage_T(X,Z) :- T(X,Z,Y), not Rlvant_T(X,Z,Y).
Garbage_S(X,Y) :- not Rlvant_S(X,Y,Z), S(X,Y,Z).
Any1Emb_0(X,Z_0,Y_0,X,Y_1,Z_1) :- S(X,Y_1,Z_1), S(X,Y_0,Z_0), Eq_T(X,Z_0,X,Z_1), T(X,Z_1,Y_1), Eq_S(X,Y_1,X,Y_0), T(X,Z_0,Y_0).
Rel1Emb_0(X,Z,Y,X,Y,Z) :- T(X,Z,Y), S(X,Y,Z).
Irr1Emb_0(X,Z_0,X,Y_1) :- not Rel1Emb_0(X,Z_0,Y_0,X,Y_1,Z_1), Any1Emb_0(X,Z_0,Y_0,X,Y_1,Z_1).
Garbage_T(X,Z_0) :- Irr1Emb_0(X,Z_0,X,Y_1).
Garbage_S(X,Y_1) :- Irr1Emb_0(X,Z_0,X,Y_1).
Pk_0(X,Z_0,X,Y_1,X,Z_2) :- S(X,Y_1,Z_1), T(X,Z_2,Y_2), Eq_T(X,Z_2,X,Z_1), S(X,Y_0,Z_0), S(X,Y_2,Z_2), T(X,Z_1,Y_1), Neq_T(X,Z_0,X,Z_2), Eq_S(X,Y_1,X,Y_0), T(X,Z_0,Y_0).
DCon_0(X,Z_4,X,Z_4,X,Y_1) :- T(X,Z_4,Y_4), S(X,Y_4,Z_4), Pk_0(X,Z_0,X,Y_1,X,Z_2).
DCon_0(X,Z_0,X,Z_4,X,Y_1) :- Neq_S(X,Y_3,X,Y_1), DCon_0(X,Z_0,X,Z_5,X,Y_1), Pk_0(X,Z_5,X,Y_3,X,Z_4).
InLongDCycle_0(X,Z_0,X,Y_1) :- DCon_0(X,Z_2,X,Z_0,X,Y_1), Pk_0(X,Z_0,X,Y_1,X,Z_2).
Garbage_T(X,Z) :- InLongDCycle_0(X,Z,X,Y).
Garbage_S(X,Y) :- InLongDCycle_0(X,Z,X,Y).
Garbage_T(X,Z) :- T(X,Z,Y), Garbage_S(X,Y), S(X,Y,Z).
Garbage_S(X,Y) :- T(X,Z,Y), Garbage_T(X,Z), S(X,Y,Z).
Keep_T(X,Z,Y) :- T(X,Z,Y), not Garbage_T(X,Z).
Keep_S(X,Y,Z) :- not Garbage_S(X,Y), S(X,Y,Z).
Link_0(X,Z,X,Z_0) :- Keep_T(X,Z,Y), Eq_T(X,Z,X,Z_0), Keep_S(X,Y_0,Z_0), Keep_T(X,Z_0,Y_0), Keep_S(X,Y,Z).
Link_0(X,Z,X,Z_0) :- Keep_T(X,Z,Y), Keep_S(X,Y_0,Z_0), Keep_T(X,Z_0,Y_0), Eq_S(X,Y,X,Y_0), Keep_S(X,Y,Z).
Trans_0(X,Z,X,Z_0) :- Link_0(X,Z,X,Z_0).
Trans_0(X,Z,X,Z_0) :- Link_0(X,Z_1,X,Z_0), Trans_0(X,Z,X,Z_1).
Lower_0(X,Z,X,Z_0) :- X>X, Trans_0(X,Z,X,Z_0), Trans_0(X,Z,X,Z_1).
Lower_0(X,Z,X,Z_0) :- Trans_0(X,Z,X,Z_0), Z_0>Z_1, Trans_0(X,Z,X,Z_1).
IdentifiedBy_0(X,Z,X,Z_0) :- Trans_0(X,Z,X,Z_0), not Lower_0(X,Z,X,Z_0).
N_T(X,Z,X,Z_0) :- T_0(X,Z_0,X,Z,Y,X,Y,Z).
N_S(X,Y,X,Z_0) :- T_0(X,Z_0,X,Z,Y,X,Y,Z).
T_0(X,Z_0,X,Z,Y,X,Y,Z) :- Keep_T(X,Z,Y), IdentifiedBy_0(X,Z,X,Z_0), Keep_S(X,Y,Z).
RewriteAtom_1(X) :- R(a,X), T_0(X,Z_0,X,Z,Y,X,Y,Z), not BadBlock_1(X,Z_0).
BadBlock_1(X,Z_0) :- R(a,X), not GoodFact_1(X,Z_0,Z_1_0,Z,Y,Z_1_3,Z_1_4,Z_1_5), T_0(X,Z_0,Z_1_0,Z,Y,Z_1_3,Z_1_4,Z_1_5).
GoodFact_1(X,Z_0,Z_1_0,Z,Y,Z_1_3,Z_1_4,Z_1_5) :- R(a,X), RewriteAtom_2(X,Z_0,Z,Y), Z_1_4=Y, T_0(X,Z_0,Z_1_0,Z,Y,Z_1_3,Z_1_4,Z_1_5), Z_1_0=X, Z_1_5=Z, Z_1_3=X.
RewriteAtom_2(X,Z_0,Z,Y) :- R(a,X), T_0(X,Z_0,X,Z,Y,X,Y,Z), N_T(X,Z,X,Z_0), not BadBlock_2(X,Z_0,Z,Y).
BadBlock_2(X,Z_0,Z,Y) :- R(a,X), N_T(X,Z,Z_2_0,Z_2_1), T_0(X,Z_0,X,Z,Y,X,Y,Z), not GoodFact_2(X,Z_0,Z,Y,Z_2_0,Z_2_1).
GoodFact_2(X,Z_0,Z,Y,Z_2_0,Z_2_1) :- R(a,X), Z_2_0=X, N_T(X,Z,Z_2_0,Z_2_1), Z_2_1=Z_0, RewriteAtom_3(X,Z_0,Z,Y), T_0(X,Z_0,X,Z,Y,X,Y,Z).
RewriteAtom_3(X,Z_0,Z,Y) :- R(a,X), not BadBlock_3(X,Z_0,Z,Y), N_S(X,Y,X,Z_0), T_0(X,Z_0,X,Z,Y,X,Y,Z), N_T(X,Z,X,Z_0).
BadBlock_3(X,Z_0,Z,Y) :- R(a,X), N_S(X,Y,Z_3_0,Z_3_1), not GoodFact_3(X,Z_0,Z,Y,Z_3_0,Z_3_1), T_0(X,Z_0,X,Z,Y,X,Y,Z), N_T(X,Z,X,Z_0).
GoodFact_3(X,Z_0,Z,Y,Z_3_0,Z_3_1) :- R(a,X), N_S(X,Y,Z_3_0,Z_3_1), Z_3_0=X, T_0(X,Z_0,X,Z,Y,X,Y,Z), N_T(X,Z,X,Z_0), Z_3_1=Z_0.
